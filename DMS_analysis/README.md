# Deep mutational scanning of Perth/2009 H3 HA mutant libraries generated by two approaches

This directory contains analysis of deep mutational scanning data of A/Perth/16/2009 (H3N2) HA mutant libraries generated by the helper-virus approach and the reverse-genetics approach.

## Background & Rationale

Previously, I generated Perth/2009 HA mutant libraries using a helper-virus approach described in [Doud and Bloom (2016)](https://www.mdpi.com/1999-4915/8/6/155). We employed the helper-virus strategy to reduce the bottlenecks and experimental noise associated with traditional reverse-genetics to efficiently generate diverse mutant viruses. However, to create a large stock of mutant viruses that could be used for numerous antibody selection experiments, I generated mutant virus libraries using traditional reverse genetics.

In this analysis, I will compare and evaluate the mutant libraries generated by these two orthogonal strategies. The libraries generated using a helper virus will be denoted `HV` while those generated using reverse genetics will be denoted `RG`.

Full details of the helper-virus libraries can be found in [Lee, Huddleston,...Bedford, Bloom (2018)](http://www.pnas.org/content/early/2018/08/10/1806133115) and its associated [GitHub repository](https://github.com/jbloomlab/Perth2009-DMS-Manuscript/tree/master/analysis_code).

## Organization

The analysis is performed by the Jupyter notebook [analysis_notebook.ipynb](analysis_notebook.ipynb), which contains the computer code and describes the results.

The input required to run the code are in the [./data/](./data/) subdirectory, and include the following items:

  * [./data/domains.csv](./data/domains.csv): `CSV` file that lists the HA domain associated with each site in HA
  * [./data/H3_human_alignment.fa](./data/H3_human_alignment.fa): file of subsampled human seasonal H3N2 HA sequences for running `phydms`
  * [./data/H3renumbering_scheme.csv](./data/H3renumbering_scheme.csv): file to convert from H3 sequential numbering (1, 2, 3,... etc.) to H3 numbering
  * [./data/Perth09_HA_reference.fa](./data/Perth09_HA_reference.fa): contains the reference sequence for the wildtype Perth/2009 HA
  * `./data/replicate-*_prefs.csv`: the unscaled amino-acid preference files for each replicate of the Perth/2009 HA libraries generated with a helper virus, in sequential numbering
  * [./data/summary_avgprefs_rescaled_H3num.csv](./data/summary_avgprefs_rescaled_H3num.csv): the across-replicate averaged and rescaled amino-acid preferences for the Perth/2009 HA mutant libraries generated with a helper virus, in H3 numbering. Taken from [Lee, et al.](http://www.pnas.org/content/early/2018/08/10/1806133115)
  * [./data/symlink_fastq.py](./data/symlink_fastq.py): script that symbolically links to FASTQ files. The sequence files will eventually be uploaded to the SRA and downloaded directly from the SRA.
  * [./data/wolf_epitope_sites.csv](./data/wolf_epitope_sites.csv): `CSV` file that lists HA epitope sites, as defined by [Wolf, et al.](https://biologydirect.biomedcentral.com/articles/10.1186/1745-6150-1-34)
  * [./data/HVlibrary_stats/](./data/HVHVlibrary_stats/): subdirectory that contains plots showing sequencing summary statistics for the helper-virus libraries. Taken from the [analysis notebook](https://github.com/jbloomlab/Perth2009-DMS-Manuscript/tree/master/analysis_code) of [Lee, et al.](http://www.pnas.org/content/early/2018/08/10/1806133115).